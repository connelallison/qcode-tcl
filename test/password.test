package require tcltest
eval ::tcltest::configure $argv
# Ensure package is loaded from ./qcode rather than /usr/lib/tcltk
set auto_path [linsert $auto_path 0 ./qcode]
package require qcode
namespace import qc::*

namespace eval ::qcode::test {

    namespace import ::tcltest::*

    test password_complexity_check-1.0 {
        password_complexity_check too short
    } -body {
        qc::password_complexity_check qw min 4
    } -returnCodes error -result "Your password must be at least 4 characters long"

    test password_complexity_check-1.1 {
        password_complexity_check too long
    } -body {
        qc::password_complexity_check qwertyuiop max 9
    } -returnCodes error -result "Your password must be less than 9 characters long"

    test password_complexity_check-1.2 {
        password_complexity_check not enough classes
    } -body {
        qc::password_complexity_check qwertyuiop minclass 2
    } -returnCodes error -result "Your password must contain at least 2 of uppercase, lowercase, numeric or punctuation"

    test password_complexity_check-1.3 {
        password_complexity_check ok
    } -body {
        qc::password_complexity_check qwE5u^op max 9 min 7 minclass 4
    } -result "true"


    cleanupTests
}
namespace delete ::qcode::test
